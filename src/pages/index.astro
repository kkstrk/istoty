---
import { Cloudinary } from "@cloudinary/url-gen";
import { fit } from '@cloudinary/url-gen/actions/resize';

import Layout from '../layouts/Layout.astro';
import _data from './data.json';

const cloudinary = new Cloudinary({
	cloud: { cloudName: 'istoty' }
});

const data = _data.map(({ id, title, images }) => ({
	id,
	title,
	href: `/title/${id}`,
	src: cloudinary.image(images[0])
		.resize(fit().width(800))
		.toURL(),
}));
---
<Layout>
	<section>
		{data.map(({ id, title, href, src }) => (
			<article>
				<a href={href}>
					<img src={src} />
					<div class="caption">
						<span>{id}</span>
						<span>{title}</span>
					</div>
				</a>
			</article>
		))}
	</section>
</Layout>

<style>
	section {
		margin: 0 var(--margin) var(--margin);
		display: flex;
		flex-direction: column;
		flex-grow: 1;
	}
	a {
		display: flex;
		flex-direction: column;
		align-items: stretch;
	}
	.caption {
		padding: 0.7rem 0;
		display: flex;
		justify-content: space-between;
	}

	@media (min-width: 992px) {
		section {
			flex-direction: row;
			justify-content: space-between;
		}
		article:nth-child(1) {
			align-self: flex-end;
			width: 33vw;
		}
		article:nth-child(2) {
			align-self: flex-start;
			width: 20vw;
		}
		article:nth-child(3) {
			align-self: center;
			width: 33vw;
		}
	}
</style>
